<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Staff Rota & Task Checklist</title>
  <!-- PWA Manifest Link -->
  <link rel="manifest" href="manifest.json">
  <style>
    /* Holiday Styling */
    .calendar-day.holiday {
      background: #ffe6e6;
      border: 1px solid #ff4d4d;
      position: relative;
    }
    .calendar-day.holiday::before {
      content: attr(data-holiday-name);
      position: absolute;
      top: 2px;
      left: 2px;
      right: 2px;
      background: #ff4d4d;
      color: #fff;
      font-size: 0.6em;
      text-align: center;
      border-radius: 3px;
      padding: 1px 0;
      line-height: 1;
    }
    /* rest of existing CSS... */
  </style>
</head>
<body>
  <!-- ... existing body ... -->
  <!-- Admin View: Add Holiday Section -->
  <section id="admin-holidays" class="admin-section">
    <h3>Manage Holidays</h3>
    <form id="holiday-form">
      <div>
        <label for="holiday-date">Date:</label>
        <input type="date" id="holiday-date" required>
      </div>
      <div>
        <label for="holiday-name">Name:</label>
        <input type="text" id="holiday-name" placeholder="e.g., Bank Holiday" required>
      </div>
      <button type="submit">Add Holiday</button>
    </form>
    <ul id="holiday-list">
      <!-- holiday items -->
      <li class="no-data">No holidays defined.</li>
    </ul>
  </section>

  <script>
    // Data key
    const LS_KEYS = { /*...*/, HOLIDAYS: 'holidays' };
    let holidays = [];

    function saveHolidays() {
      localStorage.setItem(LS_KEYS.HOLIDAYS, JSON.stringify(holidays));
    }

    function loadHolidays() {
      const data = localStorage.getItem(LS_KEYS.HOLIDAYS);
      holidays = data ? JSON.parse(data) : [];
    }

    function renderHolidayList() {
      const list = document.getElementById('holiday-list');
      list.innerHTML = '';
      if (!holidays.length) {
        list.innerHTML = '<li class="no-data">No holidays defined.</li>';
        return;
      }
      holidays.forEach((h, i) => {
        const li = document.createElement('li');
        li.innerHTML = `
          <span>${h.date} - ${h.name}</span>
          <button data-index="${i}" class="delete-holiday">Delete</button>
        `;
        list.appendChild(li);
      });
    }

    document.getElementById('holiday-form').addEventListener('submit', e => {
      e.preventDefault();
      const date = document.getElementById('holiday-date').value;
      const name = document.getElementById('holiday-name').value.trim();
      if (!date || !name) return;
      holidays.push({ date, name });
      saveHolidays();
      renderHolidayList();
      renderCalendar();
      e.target.reset();
    });

    document.getElementById('holiday-list').addEventListener('click', e => {
      if (!e.target.classList.contains('delete-holiday')) return;
      const idx = +e.target.dataset.index;
      holidays.splice(idx, 1);
      saveHolidays();
      renderHolidayList();
      renderCalendar();
    });

    // Integrate in initializeData
    function initializeData() {
      // ... existing loads
      loadHolidays();
    }

    // In renderCalendar, before appending dayCell:
    // if (holidays.find(h => h.date === formattedDate)) {
    //   dayCell.classList.add('holiday');
    //   dayCell.setAttribute('data-holiday-name', holidays.find(h => h.date===formattedDate).name);
    // }

    // On DOMContentLoaded, after initApp:
    // renderHolidayList();

    // ... rest of JS ...
  </script>
</body>
</html>
